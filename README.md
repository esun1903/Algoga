## ì•Œê³ ê°€ğŸ“• - ì•Œê³ ë¦¬ì¦˜ì„ ì•Œê³ ê°€

![https://user-images.githubusercontent.com/68232654/119593578-33591980-be15-11eb-9e58-2db1c1bb0602.png](https://user-images.githubusercontent.com/68232654/119593578-33591980-be15-11eb-9e58-2db1c1bb0602.png)

## âœï¸í”„ë¡œì íŠ¸ ê°œìš”

<b>í”„ë¡œì íŠ¸ ê¸°ê°„ : 2021.03.08 ~ 2021.04.09</b>

**ì•Œê³ ê°€ - ì•Œê³ ë¦¬ì¦˜ ë¬¸ì œ í’€ì´ ëŠ¥ë ¥ì„ ë†’ì—¬ì£¼ëŠ” ì•Œê³ ë¦¬ì¦˜ ë¬¸ì œ ì¶”ì²œ ì„œë¹„ìŠ¤**

- ì•Œê³ ë¦¬ì¦˜ ê³µë¶€ë¥¼ ë§‰ ì‹œì‘í•˜ê±°ë‚˜, ë§ì´ í’€ì—ˆì§€ë§Œ ì‹¤ë ¥ì´ ì˜ í–¥ìƒë˜ì§€ ì•ŠëŠ” ê²½ìš°ë¥¼ ìœ„í•œ ì•Œê³ ë¦¬ì¦˜ ë¬¸ì œ ì¶”ì²œ ë° ì •ë¦¬ í”Œë«í¼ì…ë‹ˆë‹¤.
- ë‚´ê°€ í‘¼ ë¬¸ì œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë‚´ê°€ ìì£¼ í‹€ë¦¬ëŠ” ìœ í˜•, ë§ì´ í’€ì—ˆì§€ë§Œ ë³´ì¶©í•  ìœ í˜• ë“± ë‚´ê°€ í’€ë©´ ì¢‹ì€ ë¬¸ì œë“¤ì„ ì¶”ì²œí•´ì¤ë‹ˆë‹¤.
- ë¬¸ì œë¥¼ í’€ê³  ë‚´ê°€ í‘¼ ë¬¸ì œë¥¼ ì •ë¦¬í•˜ê³  ë‹¤ë¥¸ ì‚¬ëŒë“¤ê³¼ ë¬¸ì œ í’€ì´ ë°©ë²•ì„ ê³µìœ í•˜ë©° ì‹¤ë ¥ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br>

## ğŸ‘©ğŸ»â€ğŸ’»ğŸ‘¨ğŸ»â€ğŸ’»ì•Œê³ ê°€ë¥¼ ë§Œë“  ì‚¬ëŒë“¤

| íŒ€ì›   | ì—­í•     |
| ------ | ------- |
| ìµœì€ì„  | BE      |
| í‘œê¸°ë™ | BE      |
| ê¶Œì˜ì¼ | BE      |
| ì´ë™í¬ | FE    |
| ë°•ì² ì™„ | FE    |


<br>

### â“ ë¬¸ì œì¸ì‹
<br>
<img src = "[https://user-images.githubusercontent.com/68232654/119594053-0ce7ae00-be16-11eb-8639-40ed9a5383a2.png](https://user-images.githubusercontent.com/68232654/119594053-0ce7ae00-be16-11eb-8639-40ed9a5383a2.png)" width="800px">

### ğŸ‘¨ğŸ»â€ğŸ’¼ í˜ë¥´ì†Œë‚˜ ì„¤ì •

ì•Œê³ ë¦¬ì¦˜ì„ ì˜ í•˜ê³  ì‹¶ì€ ì·¨ì—…ì¤€ë¹„ìƒ ë¹„ì „ê³µìƒ ê¹€ì•Œëª», ì „ê³µìƒ ê¹€ì•Œê³ 
<br>
<img src = "[https://user-images.githubusercontent.com/38427646/126605603-d1897cec-f187-4526-917c-d2c928341ff0.png](https://user-images.githubusercontent.com/38427646/126605603-d1897cec-f187-4526-917c-d2c928341ff0.png)" width="800px">
### ğŸ’ğŸ»â€â™€ï¸ í•´ê²°ë°©ì•ˆ

<br>

<img src = "[https://user-images.githubusercontent.com/38427646/126605707-b39a7acf-cc36-4d62-8bd6-eb403883f9dd.png](https://user-images.githubusercontent.com/38427646/126605707-b39a7acf-cc36-4d62-8bd6-eb403883f9dd.png" width="800px">


### âœ”ï¸ ì£¼ìš” ì„œë¹„ìŠ¤ ê¸°ëŠ¥

1. ë©”ì¸í˜ì´ì§€ - íšŒì›ê°€ì…ì‹œ ì…ë ¥ ë°›ì€ **ë°±ì¤€ ì•„ì´ë””ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¬¸ì œ ì¶”ì²œ**

2. ë©”ì¸í˜ì´ì§€ - í”„ë¡œí•„ ë° **ê¹ƒí—ˆë¸Œ ì”ë””ì‹¬ê¸°**ğŸŒ± ê¸°ëŠ¥ (ì¼ìë³„ë¡œ ê²€ìƒ‰ ê°€ëŠ¥)

3. ë§ˆì´í˜ì´ì§€ - ìì‹ ì´ í‘¼ ë¬¸ì œì™€ ë¡œê·¸, ë¬¸ì œ ì¶”ì²œ ëª©ë¡ í™•ì¸

4. ë¬¸ì œ ë“±ë¡ - ì‚¬ìš©ìê°€ í‘¼ ë¬¸ì œë“¤ì„ **ìœ í˜•ë³„&ì–¸ì–´ë³„ì— ë§ì¶”ì–´ ì‘ì„±** ë° ê·¸ì— ëŒ€í•œ **ì„¤ëª…ì€** **ë§ˆí¬ë‹¤ìš´**ìœ¼ë¡œ ì‘ì„± ê°€ëŠ¥

5. í’€ì´ í™•ì¸ - ë¬¸ì œ ë³„ë¡œ ìì‹ ì˜ í’€ì´ ë°©ë²•ê³¼ **ê³µê°œë˜ì–´ ìˆëŠ” ë‹¤ë¥¸ ì‚¬ëŒë“¤ì˜ í’€ì´ ê³µìœ  ê°€ëŠ¥** 

6. ë‹¤í¬ëª¨ë“œ / ê¸°ë³¸ëª¨ë“œ ê¸°ëŠ¥ 

### ğŸŒ± Tech Log & Cooperation

ì§„í–‰ ìƒí™©ì€ **ìŠ¤í¬ëŸ¼ê³¼ íšŒì˜ë¡**ì„ í†µí•´ ì§„í–‰í•˜ê³  ìˆìŠµë‹ˆë‹¤.

**1ì¼ 1ìŠ¤í¬ëŸ¼**ìœ¼ë¡œ ë…¸ì…˜ì— ì˜¬ë ¤ ì´ìŠˆë“¤ì„ ê³µìœ í•˜ê³  ìˆìœ¼ë©°

**íšŒì˜ë¥¼ ì§„í–‰ ì‹œ íšŒì˜ë¡ì„ ì‘ì„±**í•˜ì—¬ ì¼ì°¨ë³„ë¡œ ì •ë¦¬í•˜ê³  ìˆìŠµë‹ˆë‹¤.

<br>

### [ì‹¤ì œ í™ˆí˜ì´ì§€](http://i4a303.p.ssafy.io/)
### [ì»¨ë²¤ì…˜](https://www.notion.so/332cddb89bff4354b3aee8bc1d2746a8)
### ğŸŒ± Tech Stack
### System architecture

<img src = "[https://user-images.githubusercontent.com/38427646/126262711-ae506989-798f-4143-978a-882827bdd6ef.png](https://user-images.githubusercontent.com/68232654/119595810-158db380-be19-11eb-81d8-b70d8ed77e9d.png)" width="800px">

<br>

<details>
<summary><b>âœ”ï¸ERD</b></summary>
<img src = "[https://user-images.githubusercontent.com/38427646/126273089-c15b39f8-c1eb-4cff-a8c9-f6d9caf6aee0.png](https://user-images.githubusercontent.com/68232654/119595178-1a059c80-be18-11eb-8202-5f4d6675040f.png)" width="800px">
</details>

<details>
<summary><b>âœ”ï¸APITable</b></summary>
<img src = "[https://user-images.githubusercontent.com/38427646/126273089-c15b39f8-c1eb-4cff-a8c9-f6d9caf6aee0.png](https://user-images.githubusercontent.com/68232654/119595178-1a059c80-be18-11eb-8202-5f4d6675040f.png)" width="800px">

<img src = "[https://user-images.githubusercontent.com/38427646/126273089-c15b39f8-c1eb-4cff-a8c9-f6d9caf6aee0.png"](https://user-images.githubusercontent.com/68232654/119596269-ce53f280-be19-11eb-9e13-77f4abfa5768.png) width="800px">
</details>
<details>
<summary><b>ğŸ’» ì‹¤í–‰ ë°©ë²•</b></summary>

#### ì•Œê°€ ë°°í¬ ê³¼ì •

##### ğŸ“˜1. EC2 ì ‘ì† & ë„ì»¤ ì´ë¯¸ì§€ ìƒì„±

**1.1 íŒŒì´ì¬ ì„¤ì¹˜ (ì•Œê³ ê°€ ì„œë¹„ìŠ¤ ê¸°ì¤€)**
Python 3.6.1

**1.2 ë„ì»¤ ì„¤ì¹˜**
Docker  20.10.5

**1.3** **MySQL Docker ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ**

```
$ docker pull mysql:8.0.17

```

**1.4 Docker ì´ë¯¸ì§€ í™•ì¸**

```
$ docker images

```

**1.5 í•œê¸€ì´ ê¹¨ì§€ì§€ ì•Šë„ë¡ ì„¤ì •í•˜ë ¤ë©´ ì•„ë˜ ì¸ìê°’ì„ ë„£ì–´ì£¼ì–´ì•¼ í•œë‹¤.**

```
$  --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci

```

**1.6 Docker MySQL ì»¨í…Œì´ë„ˆ ìƒì„± ë° ì‹¤í–‰**

```
$ docker run -d -p 3306:3306 -e MYSQL_ROOT_PASSWORD=ssafy1234 --name ssafy-mysql -v /Users/ssafy/datadir:/var/lib/mysql mysql:8.0.17 --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci

MYSQL_ROOT_PASSWORD = ssafy1234
mysql -ssafy

```

**1.7 MySQL ì»¨í…Œì´ë„ˆ bash ì‰˜ ì ‘ì†**
docker exec ëª…ë ¹ì„ ì‚¬ìš©í•˜ì—¬ docker ì»¨í…Œì´ë„ˆì— ì ‘ê·¼í•œ ë‹¤ìŒ MySQLì— ë¡œê·¸ì¸í•œë‹¤.

```
$ docker exec -it ssafy-mysql bash
$ root@f3aasdasdasd8:/#mysql -u root -p

```

mysql>

ë°ì´í„°ë² ì´ìŠ¤ì™€ ì‚¬ìš©ìë¥¼ ìƒì„±í•˜ê³  (ì»¨í…Œì´ë„ˆ ë‚´ì—ì„œ) MySQLì—ì„œ ê¶Œí•œì„ ë¶€ì—¬í•œë‹¤.
ssafy ì‚¬ìš©ìë¥¼ ìƒì„±í•˜ê³ , ëª¨ë“  ê¶Œí•œì„ ë¶€ì—¬í•œë‹¤.
ë³€ê²½ëœ ê¶Œí•œ ì ìš©
ì¤‘ìš” : ì»¨í…Œì´ë„ˆ ì™¸ë¶€ì—ì„œ MySQLì— ë¡œê·¸ì¸ë„ ê°€ëŠ¥í•´ì•¼ í•˜ë¯€ë¡œ ssafy@localhostì—ì„œ localhost ëŒ€ì‹  %ë¥¼ ì‚¬ìš©í•œë‹¤.

```
mysql> CREATE USER 'ssafy'@'%' IDENTIFIED BY 'password';
Query OK, 0 rows affected (0.00 sec)

mysql> GRANT ALL PRIVILEGES ON *.* TO 'ssafy'@'%';
Query OK, 0 rows affected (0.00 sec)

mysql> flush privileges;
Query OK, 0 rows affected (0.00 sec)

mysql> quit

```

##### ğŸ“—2. Git

2-1. git install  ë¸Œëœì¹˜ master ê¸°ì¤€

2-2. git clone  í•´ë‹¹ ì„œë¹„ìŠ¤ ì£¼ì†Œ

---

##### ğŸ“’3. EC2 ì ‘ì† (1ê³¼ ë™ì¼í•œ í™”ë©´ì—ì„œ ì§„í–‰í•˜ë©´ ë¨)

cd s04p23a302

---

##### ğŸ“•4. Frontend ë°°í¬

4-1. cd algoga-frontend

```
cd algoga-frontend

```

4-2. npm install

```
$ npm install

```

4-3. npm run serve    ----> í™•ì¸í•˜ëŠ” ëª…ë ¹ì–´

```
$ npm run serve

```

4-4. npm run build    â€”â€”> dist ìƒì„±

```
$ npm run build

```

---

##### ğŸ“•5. Backend ë°°í¬ ë° ê°€ìƒí™˜ê²½ êµ¬ì¶•

5-1.

```
$ cd algoga-backend

```

5-2. my_settings.py ì‘ì„± [mysetting.py](http://mysetting.py/) ìœ„ì¹˜ algoga-backend/

```
DATABASES = {
'default': {
'ENGINE': 'django.db.backends.mysql',
'NAME': 'db-name',
'USER': 'xxxxx',
'PASSWORD':'xxxxx',
'HOST': 'xxxxxxx',
'PORT': '3306',
}
}

SECRET_KEY = 'xxxxxxx'

EMAIL = {
'EMAIL_BACKEND' : 'django.core.mail.backends.smtp.EmailBackend',
'EMAIL_USE_TLS' : True,
'EMAIL_PORT' : 587,
'EMAIL_HOST' : '[smtp.googlemail.com](<http://smtp.googlemail.com/>)',
'EMAIL_HOST_USER' : 'xxxxxx',
'EMAIL_HOST_PASSWORD' : 'xxxxxxx',
}

###########################AWS
AWS_ACCESS_KEY_ID = 'xxxxxxxX' # .csv íŒŒì¼ì— ìˆëŠ” ë‚´ìš©ì„ ì…ë ¥ Access key ID
AWS_SECRET_ACCESS_KEY = 'xxxxxxxxx' # .csv íŒŒì¼ì— ìˆëŠ” ë‚´ìš©ì„ ì…ë ¥ Secret access key
AWS_REGION = 'ap-northeast-2'

###S3 Storages
AWS_STORAGE_BUCKET_NAME = 'xxxx' # ì„¤ì •í•œ ë²„í‚· ì´ë¦„
AWS_S3_CUSTOM_DOMAIN = '%s.s3.%[s.amazonaws.com](<http://s.amazonaws.com/>)' % (AWS_STORAGE_BUCKET_NAME,AWS_REGION)
AWS_S3_OBJECT_PARAMETERS = {
'CacheControl': 'max-age=86400',
}

DEFAULT_FILE_STORAGE = 'storages.backends.s3boto3.S3Boto3Storage'

```

---

**xxxxx ìì‹ ì˜ ì•Œë§ëŠ” ë‚´ìš©ìœ¼ë¡œ ë„£ê¸°**

5-3. ê°€ìƒí™˜ê²½ êµ¬ì¶•

```
$ python3 -m venv env

```

5-4 . makemigrations,migrate,êµ¬ë™ í™•ì¸

```
$ python manage.py makemigrations
$ python manage.py migrate
$ python manage.py runserver

```

algoga-backend/ë¡œ ì´ë™

5-9. nginxì„¤ì¹˜
5-10. uwsgi ì„¤ì¹˜

5-11. sudo apt-get install nginx

```
$ sudo apt-get install nginx

```

5-12. pip install uwsgi

```
$ pip install uwsgi

```

5-13. vi algoga_uwsgi.ini

```
$ vi algoga_uwsgi.ini

```

```
[uwsgi]
chdir = /home/ubuntu/algoga1.0/s04p23a302/algoga-backend
module = backend.wsgi

socket = /home/ubuntu/algoga1.0/s04p23a302/algoga-backend/algoga.sock

socket = 127.0.0.1:8001

chmod-socket = 666
vacuum = true

#home = /home/jihun/.pyenv/versions/algoga-backend/
#virtualenv = /home/jihun/.pyenv/versions/algoga-backend/

daemonize = /home/ubuntu/algoga1.0/s04p23a302/algoga-backend/algoga_uwsgi.log

die-on-term = true

```

module : django í”„ë¡œì íŠ¸ë¥¼ ìƒì„±í•˜ë©´ ìë™ìœ¼ë¡œ ìƒì„±ë˜ëŠ” wsgi íŒŒì¼ì„ ì§€ì •í•œë‹¤.<br>
socket : socket íŒŒì¼ì„ ì´ìš©í•˜ëŠ” ê²½ìš° ì†Œì¼“ì´ ìƒì„±ë  ìœ„ì¹˜ì™€ í•¨ê»˜ .sock íŒŒì¼ëª…ì„ ì…ë ¥í•œë‹¤. ip, portë¥¼ ì´ìš©í•˜ê³  ì‹¶ì€ ê²½ìš° ì£¼ì„ìœ¼ë¡œ ì²˜ë¦¬ëœ ë¶€ë¶„ê³¼ ê°™ì´ ì§€ì •í•˜ë©´ ëœë‹¤.<br>
home, virtualenv : virtualenvë¥¼ ì´ìš©í•˜ëŠ” ê²½ìš° ê°€ìƒ í™˜ê²½ì˜ ê²½ë¡œë¥¼ ì§€ì •í•´ì¤˜ì•¼ í•œë‹¤.<br>
daemonize : ë°±ê·¸ë¼ìš´ë“œë¡œ ì‹¤í–‰ í•˜ë„ë¡ í•˜ëŠ” ì„¤ì •ì„ í•˜ë©´ì„œ ë¡œê·¸ê°€ ì €ì¥ë  íŒŒì¼ ìœ„ì¹˜ë¥¼ ì§€ì •í•œë‹¤.<br>

ê°€ìƒí™˜ê²½ ìœ„ì—ì„œ ë°°í¬í•˜ì‹œë©´ home,virtualenv ì£¼ì„ì œê±°

5-14. $ uwsgi --ini algoga_uwsgi.ini

```
 $ uwsgi --ini algoga_uwsgi.ini;

```

ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ì´ ë˜ë©´ memorist.sock ì†Œì¼“ íŒŒì¼ì´ ìƒì„±ë˜ê³ , ë¡œê·¸ê°€ memorist_uwsgi.logì— ê¸°ë¡ëœë‹¤.

5-15. algoga_uwsgi.log  // algoga.sock  ìƒì„±ë¨

5-16. killall uwsgi; ë°±ê·¸ë¼ìš´ë“œ ì—ì„œ ì‹¤í–‰ë˜ëŠ” ë°±ì„œë²„ ì£½ì´ê¸°

```
$ killall uwsgi

```

5-17.  uwsgi --ini algoga_uwsgi.ini ë°±ì—”ë“œì„œë²„ ê°€ë™

```
$ uwsgi --ini algoga_uwsgi.ini

```

5-18. sudo vim /etc/nginx/sites-enabled/default

```
 sudo vim /etc/nginx/sites-enabled/default

```

nignx

5.19. frotend ê²½ë¡œ ë§ì¶”ê¸°
5-20. backend reverse proxy ì„¤ì • ì¶”ê°€

ì—°ê²° ê³¼ì •

```
server {
listen 80;
...
..

root /home/ubuntu/algoga1.2/s04p23a302/frontend/algoga-frontend/dist

location / {
	# First attempt to serve request as file, then
	# as directory, then fall back to displaying a 404.
	try_files $uri $uri/ =404;
}

     location /apps {

       	include uwsgi_params;
	uwsgi_pass unix:/home/ubuntu/algoga1.2/s04p23a302/backend/backend/algoga.sock;
	#backend sock ìˆë˜ ìœ„ì¹˜

}

```

##### 6. Syntax ê²€ì‚¬ ë° Nginx ì¬ì‹œì‘

ì„¤ì • ë³€ê²½ í›„ syntax ê²€ì‚¬ í•„ìˆ˜

```
$ sudo nginx -t

```

ì„¤ì • ë³€ê²½ í›„ Nginx ì¬ì‹œì‘

```
$ sudo service nginx restart

```

</details>
